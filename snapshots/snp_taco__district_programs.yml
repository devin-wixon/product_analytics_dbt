version: 2

snapshots:
  - name: snp_taco__district_programs
    relation: source('taco', 'raw_taco__districts_programs')
    config:
      unique_key: "district_id || '-' || program_id"
      strategy: check
      check_cols: 'all'
      hard_deletes: 'new_record'
      # dbt_valid_to_current:  "{{ var('dbt_valid_to_current') }}"