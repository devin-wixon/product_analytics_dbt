version: 2

models:
  - name: dim_programs_most_recent
    description: |
      Purpose: Provides most recent information on Lilypad programs.
      Granularity: One row per program.
      Filters: Program record with the most recent `dbt_valid_from` date.
    columns:
      - name: program_id
        description: "{{ doc('program_id') }}"
        tests:
          - unique
          - not_null
      - name: is_program_deleted
        description: "{{ doc('is_entity_deleted') }}"
      - name: is_program_district_auto_add
        description: "{{ doc('is_program_district_auto_add') }}"
      - name: program_license_type
        description: "{{ doc('program_license_type') }}"
      - name: program_release_year
        description: "{{ doc('program_release_year') }}"
      - name: program_market_specific
        description: "{{ doc('program_market_specific') }}"
      - name: program_order_number
        description: "{{ doc('program_order_number') }}"
      - name: dbt_valid_from
        description: "{{ doc('dbt_valid_from') }}"
      - name: dbt_valid_to
        description: "{{ doc('dbt_valid_to') }}"