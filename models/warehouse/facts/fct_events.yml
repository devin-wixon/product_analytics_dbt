version: 2

models:
  - name: fct_events
    description: |
      Purpose: Tracks user interactions and behaviors within the Lilypad application for analytics and reporting.
      Granularity: One row per event occurrence.
      Filters: Excludes raw `event_path` and `event_value` columns; includes enriched and parsed event data.
      Notes: Events are enriched with dimensional information, parsed IDs, and boolean flags for event categorization.
    tests:
      # confirm incremental model row count matches source table row count
      - dbt_utils.equal_rowcount:
          config:
            enabled: "{{ target.name != 'Development' }}"
          arguments:
            compare_model: source('lilypad', 'raw_lilypad__events_log')    
    columns:
      - name: event_id
        description: "{{ doc('event_id') }}"
        tests:
          - unique
          - not_null
      - name: server_timestamp
        description: "{{ doc('server_timestamp') }}"
      - name: client_timestamp
        description: "{{ doc('client_timestamp') }}"
      - name: user_id
        description: "{{ doc('user_id') }}"
      - name: event_name
        description: "{{ doc('event_name') }}"
      - name: event_category
        description: "{{ doc('event_category') }}"
      - name: event_type
        description: "{{ doc('event_type') }}"
      - name: event_value_human_readable
        description: "{{ doc('event_value_human_readable') }}"
      - name: server_event_date
        description: "{{ doc('server_event_date') }}"
      - name: client_event_date
        description: "{{ doc('client_event_date') }}"
      - name: path_entered
        description: "{{ doc('path_entered') }}"
      - name: path_left
        description: "{{ doc('path_left') }}"
      - name: program_id
        description: "{{ doc('program_id') }}"
      - name: resource_id
        description: "{{ doc('resource_id') }}"
      - name: week_number
        description: "{{ doc('week_number') }}"
      - name: application_name
        description: "{{ doc('application_name') }}"
      - name: event_path
        description: "{{ doc('event_path') }}"
      - name: event_value
        description: "{{ doc('event_value') }}"
      - name: dbt_row_batch_id
        description: "{{ doc('dbt_row_batch_id') }}"