version: 2

models:
  - name: rpt_wau_mau_by_user
    description: |
      Purpose: Provides a scaffold of all dates with associated weekly and monthly lookback windows, joined to daily event data for calculating rolling WAU/MAU metrics.
      Granularity: One row per scaffolded date and event context (user, district, program, resource, etc.).  
        Each `server_event_date` and context combination will appear in every scaffold date's lookback window.
      Filters: Excludes events where `user_role` is 'student'.
      Notes: Uses date scaffolding to enable calculation of weekly active users (7-day window) and monthly active users (28-day window) for each date.
    columns:
      # Date scaffold columns
      - name: date_day
        description: "{{ doc('date_day') }}"
      - name: mau_lookback_start_date
        description: "{{ doc('mau_lookback_start_date') }}"
      - name: wau_lookback_start_date
        description: "{{ doc('wau_lookback_start_date') }}"

      # Event dimension columns
      - name: server_event_date
        description: "{{ doc('server_event_date') }}"
      - name: school_year_label
        description: "{{ doc('school_year_label') }}"
      - name: school_year_start_date
        description: "{{ doc('school_year_start_date') }}"
      - name: user_id
        description: "{{ doc('user_id') }}"
      - name: user_role
        description: "{{ doc('user_role') }}"
      - name: event_category
        description: "{{ doc('event_category') }}"
      - name: program_id
        description: "{{ doc('program_id') }}"
      - name: program_name
        description: ""
      - name: resource_id
        description: "{{ doc('resource_id') }}"
      - name: resource_title
        description: ""
      - name: resource_type
        description: ""
      - name: district_id
        description: "{{ doc('district_id') }}"
      - name: district_name
        description: "{{ doc('district_name') }}"
      - name: district_type
        description: "{{ doc('district_type') }}"
      - name: district_state
        description: "{{ doc('district_state') }}"
      - name: is_distributed_demo_district
        description: "{{ doc('is_distributed_demo_district') }}"
      - name: application_name
        description: "{{ doc('application_name') }}"
      - name: application_name
        description: "{{ doc('application_name') }}"
      
      # Other columns
      - name: is_user_first_event_date
        description: "{{ doc('is_user_first_event_date') }}"
      - name: is_user_eligible_for_mau
        description: "{{ doc('is_user_eligible_for_mau') }}"
