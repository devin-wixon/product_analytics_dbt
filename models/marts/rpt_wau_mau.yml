version: 2

models:
  - name: rpt_wau_mau
    description: |
      Purpose: Daily user activity tracking with weekly and monthly engagement eligibility for calculating active user metrics.
      Granularity: One row per calendar date and event dimension combination (user, district, program, resource, application, event category).
      Filters: Inherits student exclusion from upstream `rpt_obt_events_dims_daily`.
      Notes: Includes eligibility flags for WAU (Weekly Active Users) and MAU (Monthly Active Users) calculations based on user first event date. Users become eligible for WAU after 7 days and MAU after 28 days from their first event.
    columns:
      # Date spine columns
      - name: date_day
        description: "{{ doc('date_day') }}"
        data_tests:
          - not_null
      - name: week_monday_date
        description: "{{ doc('week_monday_date') }}"
      - name: month_start_date
        description: "{{ doc('month_start_date') }}"
      - name: school_year_start_date
        description: "{{ doc('school_year_start_date') }}"

      # Event dimension columns
      - name: server_event_date
        description: "{{ doc('server_event_date') }}"
      - name: user_id
        description: "{{ doc('user_id') }}"
      - name: district_id
        description: "{{ doc('district_id') }}"
      - name: district_name
        description: "{{ doc('district_name') }}"
      - name: district_type
        description: "{{ doc('district_type') }}"
      - name: program_id
        description: "{{ doc('program_id') }}"
      - name: program_name
        description: ""
      - name: user_role
        description: "{{ doc('user_role') }}"
      - name: resource_id
        description: "{{ doc('resource_id') }}"
      - name: resource_type
        description: ""
      - name: application_name
        description: "{{ doc('application_name') }}"
      - name: event_category
        description: "{{ doc('event_category') }}"
      - name: example_event_id
        description: "{{ doc('example_event_id') }}"

      # User first event tracking
      - name: user_first_event_date
        description: "{{ doc('user_first_event_date') }}"

      # Activity metrics
      - name: had_events_per_user_day_context
        description: ""
      - name: n_events_per_user_day_context
        description: ""

      # Eligibility flags for active user calculations
      - name: is_eligible_for_mau
        description: ""
      - name: is_eligible_for_wau
        description: ""