version: 2

models:
  - name: stg_craft__resources
    description: |
      Purpose: Snapshot of resources data from the craft database with column typing and renaming.
      Granularity: One row per resource per snapshot, defined by `dbt_scd_id`.
    columns:
      # source tests uniqueness and not null for resource_id; this will have dups due to snapshots
      - name: dbt_scd_id
        description: "{{ doc('dbt_scd_id') }}"
        data_tests:
          - not_null
          - unique
      - name: resource_program_id
        description: "{{ doc('program_id') }}"
        data_tests:
          - relationships:
              arguments:
                to: ref('stg_craft__programs')
                field: program_id
                where: "resource_program_id is not null"
              config:
                severity: warn
      - name: is_resource_deleted
        description: "{{ doc('is_entity_deleted') }}"
