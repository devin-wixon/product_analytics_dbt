version: 2

sources:
  - name: exports
    schema: "{{ 'exports' if target.name == 'prod' else target.schema }}"
    description: "Tables exported from dbt semantic layer saved queries, used as a source for unioning to create performant BI models."
    tables:
{%- set time_grains = get_time_grains() %}
{%- set dimension_combos = get_all_dimension_combinations() %}

      # Dynamically generated BI (ex: Tableau) exports
{%- for time_grain in time_grains %}
{%- for dimension_combo in dimension_combos %}
      - name: qexptbl_{{ time_grain.name }}_{{ dimension_combo.id }}
{%- endfor %}
{%- endfor %}